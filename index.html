<head>
  <title>subs</title>
  <meta charset="utf-8">
</head>

<link rel="stylesheet" type="text/css" href="srt.css">
<script src="/modernizr_rtc.js"></script>

<body onload="salutinit()">
  <div id="container">
    <div id="srt">
      Bonjour
    </div>
    <div id="checklist">
      <li id="q1">vous avez le temps</li>
      <li id="q2">disponibilité</li>
      <li id="q3">à la maison</li>
      <li id="q4">intimité</li>
      <li id="q5">son</li>
      <li id="q6">focus</li>
      <li id="q7">focus renforcé</li>
      <li id="q8">inscription</li>
    </div>
    <div id="bouttons">
      <button id="oui">oui</button>
      <button id="non">non</button>
    </div>
  </div>

  <script>

// TO DO

// cookie quand quelqu'un arrive au bout
// attention y'a un bug avec les boutons que j'ai pseudo-rêglé en empêchant les mouseevents quand le compteur =! x ou y


var toggle=false
// ce toggle a la con sert juste à bloquer la progression du compteur le temps de la fonction
// salut() qui sert à display un message 2 seconde puis incrémenter le compteur de 1.
// sinon le bordel s'emballe tout de suite après (la fonction delay semble juste mettre en pause
// tous les inputs du clavier

var fin=false
//pour séparer le tableau non du tableau oui

var relou=false
// lui il sert juste à changer ce que font les boutons quand la seconde question est posée
var compteur = 0

var somethingfalse = false

var delay = 3000
// le premier delay de defilement auto entre data[0] et data[1]

var data = {
  "0":"bonjour!",
  "1":"euhm",
  "2":"alors tenez, vous pouvez appuyer un coup sur la barre espace s'il vous plaît?",
  "3":"ah ouais ça marche. ",
  "4":"euh et alors tenez, encore une fois s'il vous plaît?",
  "5":"ah ouais ça marche hyper bien, super, merci. ",
  "6":"on a qu’a dire que dès que vous avez lu ce qui est écrit",
  "7":"vous pouvez appuyer sur la barre espace ",
  "8":"à votre rythme",
  "9":"c’est vous qui décidez",
  "10":"par contre prenez garde",
  "11":"il est impossible de revenir en arrière",
  "12":"c’est un peu comme si nous étions vraiment en train d’avoir une conversation",
  "13":"comme si on faisait un bout de chemin ensemble",
  "14":"bon je me présente quand même",
  "15":"c’est samuel je travaille au sein de l'équipe du projet",
  "16":"sur les trucs en rapport avec internet ",
  "17":"là je suis pas vraiment en train de vous parler pour de vrai d’ailleurs",
  "18":"en fait j’ai préparé ce texte il y a quelques jours ",
  "19":"et là présentement je suis sûrement en train de {en fonction de l’heure, au restau, etc}.",
  "20":"enfin voilà en tout cas je vous souhaite la bienvenue ici ",
  "21":"bienvenue",
  "22":"...",
  "23":"du coup si vous êtes ici c'est certainement pour assister la présentation publique de ",
  "24":"on Traversera Le Pont Une Fois Rendu À La Rivière",
  "25":"tout en restant tranquillou à la maison.",
  "26":"franchement vous avez bien fait",
  "27":"alors maintenant, il y a sûrement deux choses à savoir :",
  "28":"premièrement, ",
  "29":"bon, on est pas complètement prêts",
  "30":"le spectacle sera vraiment 'fini' en Janvier 2017 prochain",
  "31":"donc ce qu'on fait ensemble là,",
  "32":"c'est un test, un échauffement",
  "33":"et on est honorés que vous soyez là à nos côtés",
  "34":"cependant cela implique que l'expérience que vous allez vivre",
  "35":"ne sera peut-être pas tout à fait maîtrisée de bout en bout.",
  "36":"si vous êtes ok avec ça, c'est bien, ",
  "37":"sinon vous pouvez toujours décider de nous laisser ici en chemin",
  "38":"et de revenir pour les premières en janvier ou février au  Phénix de Valenciennes",
  "39":"la deuxième chose que je voulais vous dire,",
  "40":"c'est qu'il faut que nous prennions un petit temps ensemble,",
  "41":"bon, allez, quoi, trois minutes",
  "42":"c’est pour garantir que vous serez dans un cadre propice le jour du spectacle",
  "43":"c'est un peu comme avant d’aller au hammam ",
  "44":"on vous demande de préparer votre maillot de bain, votre serviette, de vous préparer à entrer dans l’ambiance ",
  "45":"dans votre cas cependant, c’est plus compliqué car",
  "46":"vous n’allez pas au hammam,",
  "47":"et il n'y aura pas non plus d'ouvreur présent dans votre dos pour vous surveiller",
  "48":"vous êtes seul maître et garant du cadre d'écoute dans lequel vous vous placez.",
  "49":"c'est plutôt chouette, ",
  "50":"mais tout comme les comédiens auront besoin de l'attention des spectateurs dans la salle,",
  "51":"on a besoin de votre attention.",
  "52":"on va avoir besoin de vous sentir,",
  "53":"de savoir qu'on est là les uns pour les autres.",
  "54":"si ça vous dit du coup,",
  "55":"je propose que nous réfléchissons ensemble à ce qui pourrait constituer ",
  "56":"le cadre dans lequel le spectacle-à-la-maison fonctionnera au mieux.",
  "57":"tiens ben déjà on va mettre un truc en place pour que vous puissiez me répondre",
  "58":"hop",
  "59":"déjà le premier truc qu'on pourrait se demander, c'est",
  "60":"est ce que vous avez encore un crédit de une minute sur les trois annoncées toute à l'heure?",
  "61":"ok, super",
  "62":"est ce que vous êtes libre mercredi à 19h30?",
  "63":"est ce que vous serez chez vous, ou chez un ami, enfin dans un espace intime à ce moment?",
  "64":"est ce que vous pourrez faire en sorte d'être seul?",
  "65":"est ce que vous disposerez d'un moyen pour écouter du son à ce moment? (hauts-parleurs, casque, etc.)",
  "66":"est ce qu'on peut se dire que vous ferez en sorte de ne pas utiliser votre téléphone portable?",
  "67":"et de vous concentrer uniquement sur le spectacle, pendant l'heure que dure la représentation?",
  "68":"bon sauf si il y a le feu chez vous hein bien entendu",
  "69":"bon super bien",
  "70":"si vous arrivez à réunir tous ces éléments mercredi ça devrait bien se passer.",
  "71":"disponibilité, à la maison, intimité, son, focus.",
  "72":"vous êtes officiellement inscrit au spectacle",
  "73":"vous êtes un S.À.L.M.",
  "74":"un Spectateur À La Maison.",
  "75":"vous n'avez qu'à revenir sur ce site web",
  "76":"à 18h45 donc, ce mercredi.",
  "77":"j'ai hâte de vous y retrouver.",
  "78":"tout bien",
  "79":"bises",
  "80":"samuel",
  "81":"...",
  "82":"(revenez à 18h45)",
}

//tous les trucs en rapport avec le temps ci-dessous
var deadline = 'November 2 2016 18:59:59 GMT+0100';


var date = new Date()
var heure = date.getHours()
var jour = date.getDate()
var presentement = "et là présentement je suis sûrement en train de "

if(heure<7){
  data[19] = presentement + "dormir dans ma chambre, à Valenciennes quoi, c'est la nuit." 
}
if(heure>=7 && heure <12){
  data[19] = presentement + "fignoler l'un ou l'autre truc dans le studio du Phénix, Valenciennes en vue de la présentation."  
}
if(heure>=12 && heure <14){
  data[19] = presentement + "déguster un bon repas de l'avant-scène avec mes collègues."  
}
if(heure>14 && heure<20){
  data[19] = presentement + "bosser comme un gros dingue dans le studio du Phénix à Valenciennes."
}
if(heure>20 && heure<22){
  data[19] = presentement + "diner avec Marion et Lieven rue d'Askièvre."
}
if(heure>22){
  data[19] = presentement + "dormir paisiblement dans ma chambre à Valenciennes."
}
if(heure>14 && heure <17 && jour==2){
  data[19] = presentement + "finir les ultimes préparatifs en régie."  
}
if(heure>18 && heure <20 && jour==2){
  data[19] = presentement + "stresser en régie, le spectacle va commencer!"  
}
if(heure=20 && jour==2){
  data[19] = presentement + "stresser en régie, le spectacle a commencé!"
}
if(heure>20 && jour==2){
  data[19] = presentement + "boire des coups, le spectacle était super et tout le monde est bien content."
}

//feature testing pour le web RTC
/*
if (Modernizr.datachannel) {
  data[5] = "<a id='pagu' href='www.google.fr'> RTC a la bien </a>"
}else{
  data[5] = "<a href='www.google.fr'> pas RTC bouh sniff </a>"
}
*/

function next(){
  var currentSub = data[compteur]
  document.getElementById("srt").innerHTML = currentSub
  // ça c'est pour virer le focus des boutons oui et non histoire de pas les activer en appuyant sur espace
}

document.onkeydown = function(e) {

  e = e || window.event
/*
pour revenir en arrière
  if(e.keyCode =='37' && compteur > 0){
    compteur -=1
    next();
  }
  */

//  KEYCODE 32 IS SPACEBAR
// KEYCIODE 78 IS "n"

if(e.keyCode =='32' && fin == false && compteur < Object.keys(data).length-1 && compteur > 0 && compteur != 60 && compteur !=62 && compteur !=63 && compteur !=64 && compteur !=65 && compteur !=66 && compteur !=67 && compteur !=68){
  compteur +=1
  next();
}

//CUES

// ptin on pourrait faire comment pour override les fonctions avec du délai si le client appuie une première fois sur espace 
// genre neuneu = false

/*
if(compteur==5){
  toggle = false;
  document.getElementById("pagu").style.cursor = "pointer"
}
*/

if(compteur==58){
// test de truc qui se range sur le côté pour faire de la place à la checklist
document.getElementById("srt").style.top = "15%"
}

if(compteur==60 | compteur >=62 && compteur <= 67){
// tout les moments où il faut que les boutons apparaissent
document.getElementById("bouttons").style.opacity = "1"
toggle = true;
}

if(compteur==72){
  document.getElementById("q8").style.opacity = "1"
  document.getElementById("container").style.backgroundColor = "black"
  document.body.style.color = "white"
}

if(compteur==75){
  document.getElementById("srt").style.top = "40%"
  document.getElementById("checklist").style.opacity = "0"
}

// fin keydown
}

function salut(){

  setTimeout(function() {
    compteur +=1;
    next();
  }, delay);

}

function salutinit(){
  setTimeout(function(){
    setTimeout(function(){
      compteur+=1;
      next();
    },delay);
    compteur +=1;
    next();
  }, delay);
}

document.getElementById("oui").addEventListener("click", function(){

  if(compteur>=62 && compteur <=67){
    if(compteur==62){
      document.getElementById("q2").style.opacity = "1"
    }
    if(compteur==63){
      document.getElementById("q3").style.opacity = "1"
    }
    if(compteur==64){
      document.getElementById("q4").style.opacity = "1"
    }
    if(compteur==65){
      document.getElementById("q5").style.opacity = "1"
    }
    if(compteur==66){
      document.getElementById("q6").style.opacity = "1"
    }
    if(compteur==67){
      document.getElementById("q7").style.opacity = "1"    
    }
    compteur +=1 
    next()


  }else{

    document.getElementById("bouttons").style.opacity = "0"
    setTimeout(function() {
      if(compteur==60){
        document.getElementById("q1").style.opacity = "1"
      }
      compteur +=1;
      next()
    }, 1000)
  }
  document.getElementById("oui").blur();
}
)


document.getElementById("non").addEventListener("click", function(){

 if(compteur>=62 && compteur <=67){
  if(compteur==62){
    document.getElementById("q2").style.listStyleImage = "url('nope.ico')";
    document.getElementById("q2").style.opacity = "1"
  }
  if(compteur==63){
    document.getElementById("q3").style.listStyleImage = "url('nope.ico')";    
    document.getElementById("q3").style.opacity = "1"
  }
  if(compteur==64){
    document.getElementById("q4").style.listStyleImage = "url('nope.ico')";
    document.getElementById("q4").style.opacity = "1"
  }
  if(compteur==65){
    document.getElementById("q5").style.listStyleImage = "url('nope.ico')";
    document.getElementById("q5").style.opacity = "1"
  }
  if(compteur==66){
    document.getElementById("q6").style.listStyleImage = "url('nope.ico')";
    document.getElementById("q6").style.opacity = "1"
  }
  if(compteur==67){
    document.getElementById("q7").style.listStyleImage = "url('nope.ico')";
    document.getElementById("q7").style.opacity = "1"   

  }
  compteur +=1 
  next()


}else{

  document.getElementById("bouttons").style.opacity = "0"
  setTimeout(function() {
    if(compteur==60){
      document.getElementById("q1").style.listStyleImage = "url('nope.ico')";
      document.getElementById("q1").style.opacity = "1"
      data[61]="ah ben zut, mais vous pouvez revenir plus tard aussi hein."
      document.getElementById("q1").innerHTML = "vous êtes pressé"
    }
    compteur +=1;
    next()
  }, 1000)
}
data[69]="bon alors on voit que toutes les conditions ne seront pas focrément réunies"
data[70]="allez, vous pouvez venir quand même hein mais assurez-vous au moins d'avoir du son,"
data[71]="sinon il ne va pas se passer grand chose chez vous."
document.getElementById("non").blur();
}
)


</script>

</body>

